# Session ID for Google Analytics
Код для формирования и передачи SessionID из браузера.

Google Analytics по умолчанию предоставляет только агрегированные данные. Для того, чтобы можно было получать исходные (“сырые”) данные, используется несколько способов: установка отправки SessionID + UserID для каждого события, передаваемого счетчиком Google, и стриминг данных в БД. 
SessionID используется для построения моделей атрибуции, а также для удобства обработки сырых данных.

Инструкцию по передаче session id и код для настройки предлагает и Симо Ахава, признанный эксперт по Google Analytics и Tag Manager. Однако его недостаток заключается в том, что код создает при каждом действии новый SessionID, не объединяя их в реальные сессии. При дальнейшем создании правил и объединении данных на их основе такая логика может оказаться подходящей. Тем не менее, мы сочли это неудобным. Наша цель была в том, чтобы SessionID присваивался корректно.

Наш код SessionID будет работать так же, как и в Google Analytics. Сессия начинается в тот момент, когда пользователь заходит на сайт, и заканчивается либо когда он закрывает браузер, либо, когда проходит 30 минут с момента его последнего действия. Ограничение в 30 минут выставляется в самом коде, и его можно менять.

Инструкция по настройке SessionId: https://github.com/room-development/session-id-for-GA/wiki/Session-ID-%D0%B4%D0%BB%D1%8F-Google-Analytics-%D1%87%D0%B5%D1%80%D0%B5%D0%B7-Google-Tag-Manager

Статья описывает как организовать передача Client ID в Google Analytics с помощью качестве пользовательского параметра Google Tag Manager.

### Создание пользовательских параметров в GA

Заходим в раздел “Администратор” в GA
![](http://roomcontent.ru/img/session-id-img-01.png)

Создаем специальный параметр в GA
![](http://roomcontent.ru/img/session-id-img-02.png)

После того, как пользовательский параметр создан, необходимо запомнить его индекс, отображаемый в списке
![](http://roomcontent.ru/img/session-id-img-03.png)


### Настройка Google Tag Manager

В первую очередь нам необходимо создать переменную «Session ID» типа «Собственный код JavaScript», которая должна содержать код из репозитория.

В результате должно получиться следующее:
![](http://roomcontent.ru/img/session-id-img-04.png)

После того как переменные были созданы нам необходимо настроить их передачу в Google Analytics. Для это нужно внести изменения в тег просмотра страницы.
![](http://roomcontent.ru/img/session-id-img-05.png)

В секции «Специальные параметры» добавляем новый параметр с индексом параметра «sid», который был создан ранее, и значением {{Session ID}}.

Далее сохраняем наши изменения и публикуем контейнер.

